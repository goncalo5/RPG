#:import settings settings

<BoxVertical@BoxLayout>:
    orientation: "vertical"
    padding: 20

<BoxHorizontal@BoxLayout>:
    orientation: "horizontal"
    padding: 20

<PlayerMenu@BoxVertical>:
    BoxHorizontal:
        BoxVertical:
            Label:
                text: "name:"
            Label:
                text: "%s" % app.player.name
        BoxVertical:
            Label:
                text: "gold:"
            Label:
                text: "%s" % app.player.gold
        BoxVertical:
            Label:
                text: "hp:"
            Label:
                text: "%s" % app.player.hp
        BoxVertical:
            Label:
                text: "speed:"
            Label:
                text: "%s" % app.player.speed
        BoxVertical:
            Label:
                text: "carried:"
            Label:
                text: "%s" % app.player.carried
        BoxVertical:
            Label:
                text: "level:"
            Label:
                text: "%s" % app.player.level
        BoxVertical:
            Label:
                text: "xp:"
            Label:
                text: "%s" % app.player.xp
    BoxHorizontal:
        BoxVertical:
            Label:
                text: "items"
            Spinner:
                text: "list"
                values: app.player.items_names
                on_text:
                    self.text = "list"
        BoxVertical:
            Label:
                text: "left hand"
            Spinner:
                selected: False
                text: app.player.equiped["left_hand"]
                values: app.player.items_availables_names
                on_text:
                    app.player.change_equipment(self, self.text, "left_hand")
        BoxVertical:
            Label:
                text: "armor"
            Spinner:
                selected: False
                text: app.player.equiped["armor"]
                values: app.player.items_availables_names
                on_text:
                    app.player.change_equipment(self, self.text, "armor")
        BoxVertical:
            Label:
                text: "right hand"
            Spinner:
                selected: False
                text: app.player.equiped["right_hand"]
                values: app.player.items_availables_names
                on_text:
                    print(55)
                    app.player.change_equipment(self, self.text, "right_hand")

<OverView>:
    BoxVertical:
        PlayerMenu
        BoxHorizontal:
            Label:
                text: root.place_name
            Button:
                text: "change place"
        BoxHorizontal:
            Button:
                text: "explore"
            Button:
                text: "buildings"
    

<InitScreen@Screen>:
    BoxVertical:
        Label:
            text: "Init"
        BoxHorizontal:
            Label:
                text: "Your name:"
            TextInput:
                id: player_name
                multiline: False
        BoxHorizontal:
            Label:
                text: "Place:"
            Spinner:
                text: app.player.place.name
                values: settings.PLACES.keys()
                on_text:
                    print("The spinner {} has text {}".format(self, self.text))
                    app.player.change_place(self.text)
                    print(app.player.place)
        BoxHorizontal:
            Label:
                text: "Item:"
            Spinner:
                id: item_to_add
                # text: settings.INIT.get("items_chose")[0]
                values: settings.INIT.get("items_chose")
                on_text:
                    print("The spinner {} has text {}".format(self, self.text))
                    print(app.player.items)
                    app.player.calc_gold_left(self.text)
            BoxVertical:
                Label:
                    text: "cost: %s" % (getattr(app, item_to_add.text).cost if item_to_add.text else 0)
                Label:
                    text: "weight: %s" % (getattr(app, item_to_add.text).weight if item_to_add.text else 0)
                Label:
                    text: "damage: %s" % (getattr(app, item_to_add.text).damage if item_to_add.text else 0)
                Label:
                    text: "damage_type: %s" % (getattr(app, item_to_add.text).damage_type if item_to_add.text else 0)
        BoxHorizontal:
            Label:
                text: "Gold: %s" % app.player.gold
            Button:
                text: "Next"
                on_press:
                    # root.manager.current = getattr(app, app.player.place).screen
                    app.player.name = player_name.text
                    app.player.add_one_item(item_to_add.text)
                    print(app.player.place.name)
                    root.manager.current = "over_view"


<Manager>:
    id: manager
    over_view: v
    InitScreen:
        name: "init_screen"
        manager: manager
    OverView:
        id: over_view
        name: "over_view"
        manager: manager