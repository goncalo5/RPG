#:import settings settings

<BoxVertical@BoxLayout>:
    orientation: "vertical"
    padding: 20

<BoxHorizontal@BoxLayout>:
    orientation: "horizontal"
    padding: 20

<PlayerMenu@BoxHorizontal>:
    BoxVertical:
        Label:
            text: "name:"
        Label:
            text: "%s" % app.player.name
    BoxVertical:
        Label:
            text: "gold:"
        Label:
            text: "%s" % app.player.gold
    BoxVertical:
        Label:
            text: "hp:"
        Label:
            text: "%s" % app.player.hp
    BoxVertical:
        Label:
            text: "speed:"
        Label:
            text: "%s" % app.player.speed
    BoxVertical:
        Label:
            text: "weight:"
        Label:
            text: "%s" % app.player.weight


<PlaceScreen@Screen>:
    BoxVertical:
        PlayerMenu
        BoxHorizontal:
            Label:
                text: root.place_name
            Button:
                text: "change place"
        BoxHorizontal:
            Button:
                text: "explore"
            Button:
                text: "buildings"
    

<InitScreen@Screen>:
    BoxVertical:
        Label:
            text: "Init"
        BoxHorizontal:
            Label:
                text: "Your name:"
            TextInput:
                id: player_name
                multiline: False
        BoxHorizontal:
            Label:
                text: "Place:"
            Spinner:
                text: app.player.place.name
                values: settings.PLACES.keys()
                on_text:
                    print("The spinner {} has text {}".format(self, self.text))
                    app.player.change_place(self.text)
                    print(app.player.place)
        BoxHorizontal:
            Label:
                text: "Item:"
            Spinner:
                id: item_to_add
                text: settings.INIT.get("items_chose")[0]
                values: settings.INIT.get("items_chose")
                on_text:
                    print("The spinner {} has text {}".format(self, self.text))
                    print(app.player.items)
                    app.player.calc_gold_left(self.text)
            BoxVertical:
                Label:
                    text: "cost: %s" % (getattr(app, item_to_add.text).cost if item_to_add.text else 0)
                Label:
                    text: "weight: %s" % (getattr(app, item_to_add.text).weight if item_to_add.text else 0)
                Label:
                    text: "damage: %s" % (getattr(app, item_to_add.text).damage if item_to_add.text else 0)
                Label:
                    text: "damage_type: %s" % (getattr(app, item_to_add.text).damage_type if item_to_add.text else 0)
        BoxHorizontal:
            Label:
                text: "Gold: %s" % app.player.gold
            Button:
                text: "Next"
                on_press:
                    # root.manager.current = getattr(app, app.player.place).screen
                    app.player.name = player_name.text
                    app.player.add_one_item(item_to_add.text)
                    print(app.player.place.name)
                    root.manager.current = "place_screen"


<Manager>:
    id: manager
    place_screen: place_screen
    InitScreen:
        name: "init_screen"
        manager: manager
    PlaceScreen:
        id: place_screen
        name: "place_screen"
        manager: manager